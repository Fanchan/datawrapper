!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).publish=t()}(this,(function(){"use strict";function e(){}function t(e,t){for(var n in t)e[n]=t[n];return e}function n(e,t){for(var n in t)e[n]=1;return e}function i(e,t){e.appendChild(t)}function s(e,t,n){e.insertBefore(t,n)}function r(e){e.parentNode.removeChild(e)}function a(e){for(;e.nextSibling;)e.parentNode.removeChild(e.nextSibling)}function o(e,t){for(var n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function c(){return document.createDocumentFragment()}function l(e){return document.createElement(e)}function u(e){return document.createTextNode(e)}function d(){return document.createComment("")}function h(e,t,n,i){e.addEventListener(t,n,i)}function p(e,t,n,i){e.removeEventListener(t,n,i)}function f(e,t,n){null==n?e.removeAttribute(t):e.setAttribute(t,n)}function m(e,t){e.data=""+t}function b(e,t,n){e.style.setProperty(t,n)}function _(){return Object.create(null)}function v(e){e._lock=!0,w(e._beforecreate),w(e._oncreate),w(e._aftercreate),e._lock=!1}function g(e,t){e._handlers=_(),e._slots=_(),e._bind=t._bind,e._staged={},e.options=t,e.root=t.root||e,e.store=t.store||e.root.store,t.root||(e._beforecreate=[],e._oncreate=[],e._aftercreate=[])}function w(e){for(;e&&e.length;)e.shift()()}function y(){this.store._remove(this)}var x={destroy:function(t){this.destroy=e,this.fire("destroy"),this.set=e,this._fragment.d(!1!==t),this._fragment=null,this._state={}},get:function(){return this._state},fire:function(e,t){var n=e in this._handlers&&this._handlers[e].slice();if(n)for(var i=0;i<n.length;i+=1){var s=n[i];if(!s.__calling)try{s.__calling=!0,s.call(this,t)}finally{s.__calling=!1}}},on:function(e,t){var n=this._handlers[e]||(this._handlers[e]=[]);return n.push(t),{cancel:function(){var e=n.indexOf(t);~e&&n.splice(e,1)}}},set:function(e){this._set(t({},e)),this.root._lock||v(this.root)},_recompute:e,_set:function(e){var n=this._state,i={},s=!1;for(var r in e=t(this._staged,e),this._staged={},e)this._differs(e[r],n[r])&&(i[r]=s=!0);s&&(this._state=t(t({},n),e),this._recompute(i,this._state),this._bind&&this._bind(i,this._state),this._fragment&&(this.fire("state",{changed:i,current:this._state,previous:n}),this._fragment.p(i,this._state),this.fire("update",{changed:i,current:this._state,previous:n})))},_stage:function(e){t(this._staged,e)},_mount:function(e,t){this._fragment[this._fragment.i?"i":"m"](e,t||null)},_differs:function(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}};var N={show:function(){var e=this,t=setTimeout((function(){e.set({visible:!0})}),400);this.set({t:t})},hide:function(){var e=this.get().t;clearTimeout(e),this.set({visible:!1})}};function T(e,t){var n,a,o,c,h=e._slotted.default;return{c:function(){n=l("div"),a=l("i"),o=u("\n        "),a.className="hat-icon im im-graduation-hat svelte-19xfki7",n.className="content svelte-19xfki7"},m:function(e,t){s(e,n,t),i(n,a),i(n,o),h&&(i(n,c||(c=d())),i(n,h))},d:function(e){e&&r(n),h&&function(e,t){for(;e.nextSibling;)t.appendChild(e.nextSibling)}(c,h)}}}function H(e){g(this,e),this._state=t({visible:!1},e.data),this._intro=!0,this._slotted=e.slots||{},this._fragment=function(e,t){var n,a,o,c=t.visible&&T(e);function d(t){e.show()}function f(t){e.hide()}return{c:function(){n=l("div"),(a=l("span")).textContent="?",o=u("\n    "),c&&c.c(),a.className="help-icon svelte-19xfki7",h(n,"mouseenter",d),h(n,"mouseleave",f),n.className="help svelte-19xfki7"},m:function(e,t){s(e,n,t),i(n,a),i(n,o),c&&c.m(n,null)},p:function(t,i){i.visible?c||((c=T(e)).c(),c.m(n,null)):c&&(c.d(1),c=null)},d:function(e){e&&r(n),c&&c.d(),p(n,"mouseenter",d),p(n,"mouseleave",f)}}}(this,this._state),e.target&&(this._fragment.c(),this._mount(e.target,e.anchor))}t(H.prototype,x),t(H.prototype,N);var A={};function k(e){void 0===e&&(e="core"),"chart"===e?window.__dw&&window.__dw.vis&&window.__dw.vis.meta&&(A[e]=window.__dw.vis.meta.locale||{}):A[e]="core"===e?dw.backend.__messages.core:Object.assign({},dw.backend.__messages.core,dw.backend.__messages[e])}function C(e,t){var n=arguments;if(void 0===t&&(t="core"),e=e.trim(),A[t]||k(t),!A[t][e])return"MISSING:"+e;var i=A[t][e];return"string"==typeof i&&arguments.length>2&&(i=i.replace(/\$(\d)/g,(function(e,t){return t=2+Number(t),void 0===n[t]?e:n[t]}))),i}function L(e,t,n,i){window._paq&&window._paq.push(["trackEvent",e,t,n,i])}function M(e,t,n,i,s){var r={method:t,body:i,mode:"cors",credentials:n};return window.fetch(e,r).then((function(e){if(!e.ok)throw new Error(e.statusText);return e.text()})).then((function(e){try{return JSON.parse(e)}catch(t){return console.warn("malformed json input",e),e}})).then((function(e){return s&&s(e),e})).catch((function(e){if(!s)throw e;console.error(e)}))}function E(e,t,n){return M(e,"POST","include",t,n)}function j(e,t){var n;return{c:function(){(n=l("p")).innerHTML='<i class="fa fa-spinner fa-pulse fa-fw"></i> loading...',n.className="mini-help"},m:function(e,t){s(e,n,t)},d:function(e){e&&r(n)}}}function U(e){var n,i,a;g(this,e),this._state=t({loading:!1},e.data),this._intro=!0,this._fragment=(n=this._state,a=n.loading&&j(),{c:function(){a&&a.c(),i=d()},m:function(e,t){a&&a.m(e,t),s(e,i,t)},p:function(e,t){t.loading?a||((a=j()).c(),a.m(i.parentNode,i)):a&&(a.d(1),a=null)},d:function(e){a&&a.d(e),e&&r(i)}}),e.target&&(this._fragment.c(),this._mount(e.target,e.anchor))}t(U.prototype,x);var I=[100,200,300,400,500,700,800,900,1e3];var S=0,O=!0;var D={publish:function(){var e=this;this.set({publishing:!0,progress:0,publish_error:!1});var t,n,i,s,r,a=this.store;a.setMetadata("publish.embed-heights",(this.get().embed_templates,t={},n=window.$,i=n(n("#iframe-vis")[0].contentDocument),s=n("h1",i).height()+n(".chart-intro",i).height()+n(".dw-chart-notes",i).height(),r=n("#iframe-vis").height(),I.forEach((function(e){i.find("h1,.chart-intro,.dw-chart-notes").css("width",e+"px");var a=n("h1",i).height()+n(".chart-intro",i).height()+n(".dw-chart-notes",i).height();t[e]=r+(a-s)})),i.find("h1,.chart-intro,.dw-chart-notes").css("width","auto"),t)),L("Chart Editor","publish"),a.store((function(){E("/api/charts/"+a.get().id+"/publish",null,(function(t){"ok"===t.status?(e.publishFinished(t.data),L("Chart Editor","publish-success")):(L("Chart Editor","publish-error",t.message),e.set({publish_error:t.message}))})),S=0,e.updateStatus()}))},updateProgressBar:function(e){this.refs.bar&&(this.refs.bar.style.width=(100*e).toFixed()+"%")},updateStatus:function(){var e=this,t=this.store;S+=.05,function(e,t,n){2===arguments.length&&"function"==typeof t?(n=t,t="include"):1===arguments.length&&(t="include"),M(e,"GET",t,null,n)}("/api/charts/"+t.get().id+"/publish/status",(function(t){t&&(t=+t/100+S,e.set({progress:Math.min(1,t)})),e.get().publishing&&setTimeout((function(){e.updateStatus()}),400)}))},publishFinished:function(e){var t=this;this.set({progress:1,published:!0,needs_republish:!1}),this.store.set({lastEditStep:5}),setTimeout((function(){return t.set({publishing:!1})}),500),this.store.set(e)},setEmbedCode:function(){var e=this.store,t=this.get();if(t){var n=t.embed_type?"embed-method-"+t.embed_type:null,i=e.get().publicUrl,s=e.getMetadata("publish.embed-codes"),r=e.getMetadata("publish.embed-height");this.set({embedCode:s&&s[n]?s[n]:'<iframe src="'+i+'" width="100%" height="'+r+'" scrolling="no" frameborder="0" allowtransparency="true"></iframe>'})}},copy:function(){var e=this;e.refs.embedInput.select();try{document.execCommand("copy")&&(L("Chart Editor","embedcode-copy"),e.set({copy_success:!0}),setTimeout((function(){return e.set({copy_success:!1})}),300))}catch(e){}},select:function(e,t){var n=this;t.preventDefault(),window.location.hash=e.id;var i,s,r=this.get().active_action;if(e.id===r)return this.set({active_action:"",Action:U});this.set({active_action:e.id}),e.mod?e.mod.App?this.set({Action:e.mod.App}):(this.set({Action:U}),this.refs.action.set({loading:!0}),e.mod.css&&(i=e.mod.css,void 0===s&&(s=null),new Promise((function(e,t){var n=document.createElement("link");n.rel="stylesheet",n.href=i,n.onload=function(){s&&s(),e()},n.onerror=t,document.head.appendChild(n)}))),function(e,t){void 0===t&&(t=null),new Promise((function(n,i){var s=document.createElement("script");s.src=e,s.onload=function(){t&&t(),n()},s.onerror=i,document.body.appendChild(s)}))}(e.mod.src,(function(){setTimeout((function(){require([e.mod.id],(function(t){Object.assign(e.mod,t),n.set({Action:e.mod.App}),t.init&&t.init(n.refs.action),e.mod.data&&n.refs.action.set(e.mod.data)}))}),200)}))):e.action&&this[e.action]?(this.set({Action:U}),this[e.action]()):"function"==typeof e.action&&(this.set({Action:U}),e.action())},duplicate:function(){var e=this.store.get().id;L("Chart Editor","duplicate"),E("/api/charts/"+e+"/copy",null,(function(e){"ok"===e.status?window.location.href="/edit/"+e.data.id+"/visualize":console.warn(e)}))}};function G(){var e=this,t=this.store.get().lastEditStep;this.set({published:t>4}),window.dw.backend.fire("edit.publish.oncreate",this),this.setEmbedCode();var n=this.store;n.observeDeep("metadata.publish.embed-codes",(function(){return e.setEmbedCode()})),n.observeDeep("metadata.publish.embed-height",(function(){return e.setEmbedCode()})),n.observeDeep("publicUrl",(function(){return e.setEmbedCode()}))}function $(e){var t=e.changed,n=e.current,i=window.dw&&window.dw.backend&&window.dw.backend.setUserData;if(t.publishing&&n.publishing&&this.updateProgressBar(n.progress),t.progress&&this.updateProgressBar(n.progress),t.embed_type&&i){var s=window.dw.backend.__userData;if(!n.embed_type||!s)return;s.embed_type=n.embed_type,window.dw.backend.setUserData(s)}if(t.embed_type&&this.setEmbedCode(),t.shareurl_type&&i){var r=window.dw.backend.__userData;if(!n.shareurl_type||!r)return;r.shareurl_type=n.shareurl_type,window.dw.backend.setUserData(r)}if(t.published){var a=window.document.querySelector(".dw-create-publish .publish-step");a&&a.classList[n.published?"add":"remove"]("is-published")}t.auto_publish&&n.auto_publish&&O&&(this.publish(),O=!1,window.history.replaceState("","",window.location.pathname))}function P(e){var t=this._svelte,n=t.component,i=t.ctx;n.select(i.action,e)}function F(e,t,n){var i=Object.create(e);return i.action=t[n],i}function q(e,t,n){var i=Object.create(e);return i.tpl=t[n],i}function B(e,t,n){var i=Object.create(e);return i.tpl=t[n],i}function z(e,t,n){var i=Object.create(e);return i.tpl=t[n],i}function J(e,t){var n;return{c:function(){(n=l("h2")).className="pad-top"},m:function(e,i){s(e,n,i),n.innerHTML=t.publishHed},p:function(e,t){e.publishHed&&(n.innerHTML=t.publishHed)},d:function(e){e&&r(n)}}}function K(t,n){var i,a=C("publish / publish-intro");return{c:function(){b(i=l("p"),"margin-bottom","20px")},m:function(e,t){s(e,i,t),i.innerHTML=a},p:e,d:function(e){e&&r(i)}}}function Q(t,n){var i,a=C("publish / republish-intro");return{c:function(){i=l("p")},m:function(e,t){s(e,i,t),i.innerHTML=a},p:e,d:function(e){e&&r(i)}}}function R(e,t){var n;return{c:function(){n=l("p")},m:function(e,i){s(e,n,i),n.innerHTML=t.publishIntro},p:function(e,t){e.publishIntro&&(n.innerHTML=t.publishIntro)},d:function(e){e&&r(n)}}}function V(e,t){var n,a,o,c,d,h,p=C("publish / publish-btn");return{c:function(){n=l("span"),a=l("i"),c=u("\n            "),d=l("span"),h=u(p),a.className=o="fa fa-fw "+(t.publishing?"fa-refresh fa-spin":"fa-cloud-upload")+" svelte-ia26hx",d.className="title svelte-ia26hx",n.className="publish"},m:function(e,t){s(e,n,t),i(n,a),i(n,c),i(n,d),i(d,h)},p:function(e,t){e.publishing&&o!==(o="fa fa-fw "+(t.publishing?"fa-refresh fa-spin":"fa-cloud-upload")+" svelte-ia26hx")&&(a.className=o)},d:function(e){e&&r(n)}}}function W(e,t){var n,a,o,c,d,h,p=C("publish / republish-btn");return{c:function(){n=l("span"),a=l("i"),c=u(" "),d=l("span"),h=u(p),a.className=o="fa fa-fw fa-refresh "+(t.publishing?"fa-spin":"")+" svelte-ia26hx",d.className="title svelte-ia26hx",n.className="re-publish"},m:function(e,t){s(e,n,t),i(n,a),i(n,c),i(n,d),i(d,h)},p:function(e,t){e.publishing&&o!==(o="fa fa-fw fa-refresh "+(t.publishing?"fa-spin":"")+" svelte-ia26hx")&&(a.className=o)},d:function(e){e&&r(n)}}}function X(e,t){var n,a,o,c,d=C("publish / publish-btn-intro");return{c:function(){n=l("div"),(a=l("div")).innerHTML='<i class="fa fa-chevron-left"></i>',o=u("\n        "),c=l("div"),a.className="arrow svelte-ia26hx",c.className="text svelte-ia26hx",n.className="publish-intro svelte-ia26hx"},m:function(e,t){s(e,n,t),i(n,a),i(n,o),i(n,c),c.innerHTML=d},d:function(e){e&&r(n)}}}function Y(e,t){var n,i=C("publish / republish-alert");return{c:function(){(n=l("div")).className="btn-aside alert svelte-ia26hx"},m:function(e,t){s(e,n,t),n.innerHTML=i},d:function(e){e&&r(n)}}}function Z(e,t){var n,i=C("publish / publish-success");return{c:function(){(n=l("div")).className="alert alert-success svelte-ia26hx"},m:function(e,t){s(e,n,t),n.innerHTML=i},d:function(e){e&&r(n)}}}function ee(e,t){var n;return{c:function(){(n=l("div")).className="alert alert-error svelte-ia26hx"},m:function(e,i){s(e,n,i),n.innerHTML=t.publish_error},p:function(e,t){e.publish_error&&(n.innerHTML=t.publish_error)},d:function(e){e&&r(n)}}}function te(e,t){var n,a,o,c,d,h,p,f=C("publish / progress / please-wait");return{c:function(){n=l("div"),a=u(f),o=u("\n        "),c=l("div"),(d=l("div")).className=h="bar "+(t.progress<1?"":"bar-success")+" svelte-ia26hx",c.className="progress progress-striped active svelte-ia26hx",n.className=p="alert "+(t.progress<1?"alert-info":"alert-success")+" publishing svelte-ia26hx"},m:function(t,r){s(t,n,r),i(n,a),i(n,o),i(n,c),i(c,d),e.refs.bar=d},p:function(e,t){e.progress&&h!==(h="bar "+(t.progress<1?"":"bar-success")+" svelte-ia26hx")&&(d.className=h),e.progress&&p!==(p="alert "+(t.progress<1?"alert-info":"alert-success")+" publishing svelte-ia26hx")&&(n.className=p)},d:function(t){t&&r(n),e.refs.bar===d&&(e.refs.bar=null)}}}function ne(e,t){var n,o,c,d,m,b=t.tpl.name;function _(){e.set({shareurl_type:o.__value})}return{c:function(){n=l("label"),o=l("input"),d=u(" "),m=l("noscript"),e._bindingGroups[0].push(o),h(o,"change",_),o.__value=c=t.tpl.id,o.value=o.__value,f(o,"type","radio"),o.name="url-type",o.className="svelte-ia26hx",n.className="radio"},m:function(e,r){s(e,n,r),i(n,o),o.checked=o.__value===t.shareurl_type,i(n,d),i(n,m),m.insertAdjacentHTML("afterend",b)},p:function(e,t){e.shareurl_type&&(o.checked=o.__value===t.shareurl_type),e.plugin_shareurls&&c!==(c=t.tpl.id)&&(o.__value=c),o.value=o.__value,e.plugin_shareurls&&b!==(b=t.tpl.name)&&(a(m),m.insertAdjacentHTML("afterend",b))},d:function(t){t&&r(n),e._bindingGroups[0].splice(e._bindingGroups[0].indexOf(o),1),p(o,"change",_)}}}function ie(e,t){var n,o,c,d,m,b=t.tpl.title;function _(){e.set({embed_type:o.__value})}return{c:function(){n=l("label"),o=l("input"),d=u(" "),m=l("noscript"),e._bindingGroups[1].push(o),h(o,"change",_),f(o,"type","radio"),o.__value=c=t.tpl.id,o.value=o.__value,o.className="svelte-ia26hx",n.className="radio"},m:function(e,r){s(e,n,r),i(n,o),o.checked=o.__value===t.embed_type,i(n,d),i(n,m),m.insertAdjacentHTML("afterend",b)},p:function(e,t){e.embed_type&&(o.checked=o.__value===t.embed_type),e.embed_templates&&c!==(c=t.tpl.id)&&(o.__value=c),o.value=o.__value,e.embed_templates&&b!==(b=t.tpl.title)&&(a(m),m.insertAdjacentHTML("afterend",b))},d:function(t){t&&r(n),e._bindingGroups[1].splice(e._bindingGroups[1].indexOf(o),1),p(o,"change",_)}}}function se(e,t){var n,o,c,d,h,p,f=t.tpl.title,b=t.tpl.text;return{c:function(){n=l("div"),o=l("b"),c=u(f),d=u(":"),h=u(" "),p=l("noscript")},m:function(e,t){s(e,n,t),i(n,o),i(o,c),i(o,d),i(n,h),i(n,p),p.insertAdjacentHTML("afterend",b)},p:function(e,t){e.embed_templates&&f!==(f=t.tpl.title)&&m(c,f),e.embed_templates&&b!==(b=t.tpl.text)&&(a(p),p.insertAdjacentHTML("afterend",b))},d:function(e){e&&r(n)}}}function re(e,t){var n;return{c:function(){n=l("p")},m:function(e,i){s(e,n,i),n.innerHTML=t.exportIntro},p:function(e,t){e.exportIntro&&(n.innerHTML=t.exportIntro)},d:function(e){e&&r(n)}}}function ae(e,t){var n,a,o,c,d,m,b,_,v=t.action.title,g=t.action.banner&&"FALSE"!=t.action.banner.text&&"-"!=t.action.banner.text&&oe(e,t);return{c:function(){n=l("li"),a=l("a"),o=l("i"),d=l("span"),b=u("\n                "),g&&g.c(),o.className=c="fa fa-"+t.action.icon+" svelte-ia26hx",d.className="title svelte-ia26hx",a._svelte={component:e,ctx:t},h(a,"click",P),f(a,"role","button"),a.href=m=t.action.url?t.action.url:"#"+t.action.id,n.className=_="action action-"+t.action.id+" "+(t.action.class||"")+" "+(t.action.id==t.active_action?"active":"")+" svelte-ia26hx"},m:function(e,t){s(e,n,t),i(n,a),i(a,o),i(a,d),d.innerHTML=v,i(n,b),g&&g.m(n,null)},p:function(i,s){t=s,i.sortedChartActions&&c!==(c="fa fa-"+t.action.icon+" svelte-ia26hx")&&(o.className=c),i.sortedChartActions&&v!==(v=t.action.title)&&(d.innerHTML=v),a._svelte.ctx=t,i.sortedChartActions&&m!==(m=t.action.url?t.action.url:"#"+t.action.id)&&(a.href=m),t.action.banner&&"FALSE"!=t.action.banner.text&&"-"!=t.action.banner.text?g?g.p(i,t):((g=oe(e,t)).c(),g.m(n,null)):g&&(g.d(1),g=null),(i.sortedChartActions||i.active_action)&&_!==(_="action action-"+t.action.id+" "+(t.action.class||"")+" "+(t.action.id==t.active_action?"active":"")+" svelte-ia26hx")&&(n.className=_)},d:function(e){e&&r(n),p(a,"click",P),g&&g.d()}}}function oe(e,t){var n,a,o,c=t.action.banner.text;return{c:function(){n=l("div"),a=u(c),n.className="banner",n.style.cssText=o=t.action.banner.style},m:function(e,t){s(e,n,t),i(n,a)},p:function(e,t){e.sortedChartActions&&c!==(c=t.action.banner.text)&&m(a,c),e.sortedChartActions&&o!==(o=t.action.banner.style)&&(n.style.cssText=o)},d:function(e){e&&r(n)}}}function ce(e,t){var n,i=t.action&&ae(e,t);return{c:function(){i&&i.c(),n=d()},m:function(e,t){i&&i.m(e,t),s(e,n,t)},p:function(t,s){s.action?i?i.p(t,s):((i=ae(e,s)).c(),i.m(n.parentNode,n)):i&&(i.d(1),i=null)},d:function(e){i&&i.d(e),e&&r(n)}}}function le(e){var a=this;g(this,e),this.refs={},this._state=t(t(this.store._init(["id","publicUrl","actions"]),{active_action:"",embed_templates:[],plugin_shareurls:[],published:!1,publishing:!1,needs_republish:!1,publish_error:!1,auto_publish:!1,progress:0,shareurl_type:"default",embed_type:"responsive",copy_success:!1,Action:U,chartActions:[{id:"duplicate",icon:"code-fork",title:C("Duplicate"),order:500,action:"duplicate"}],publishHed:"",publishIntro:"",beforeExport:null,exportHed:C("publish / export-duplicate"),exportIntro:C("publish / export-duplicate / intro"),embedCode:""}),e.data),this.store._add(this,["id","publicUrl","actions"]),this._recompute({shareurl_type:1,$id:1,$publicUrl:1,plugin_shareurls:1,published:1,chartActions:1,$actions:1},this._state),this._bindingGroups=[[],[]],this._intro=!0,this._handlers.state=[$],this._handlers.destroy=[y],$.call(this,{changed:n({},this._state),current:this._state}),this._fragment=function(e,t){var n,a,d,_,v,g,w,y,x,N,T,A,k,L,M,E,j,U,I,S,O,D,G,$,P,ae,oe,le,ue,de,he,pe,fe,me,be,_e,ve,ge,we,ye,xe,Ne,Te,He,Ae,ke,Ce,Le,Me,Ee,je,Ue,Ie,Se,Oe,De,Ge,$e,Pe,Fe,qe,Be,ze,Je,Ke,Qe,Re,Ve,We=C("publish / share-embed"),Xe=C("publish / share-url"),Ye=C("publish / share-url / fullscreen"),Ze=C("publish / help / share-url"),et=C("publish / embed"),tt=C("publish / copy"),nt=C("publish / copy-success"),it=C("publish / embed / help"),st=t.publishHed&&J(e,t);function rt(e){return e.publishIntro?R:e.published?Q:K}var at=rt(t),ot=at(e,t);function ct(e){return e.published?W:V}var lt=ct(t),ut=lt(e,t);function dt(t){e.publish()}var ht=!t.published&&X(),pt=t.needs_republish&&!t.publishing&&Y(),ft=t.published&&!t.needs_republish&&1===t.progress&&!t.publishing&&Z(),mt=t.publish_error&&ee(e,t),bt=t.publishing&&te(e,t);function _t(){e.set({shareurl_type:$.__value})}for(var vt=t.plugin_shareurls,gt=[],wt=0;wt<vt.length;wt+=1)gt[wt]=ne(e,z(t,vt,wt));var yt=new H({root:e.root,store:e.store,slots:{default:c()}}),xt=t.embed_templates,Nt=[];for(wt=0;wt<xt.length;wt+=1)Nt[wt]=ie(e,B(t,xt,wt));function Tt(n){e.copy(t.embedCode)}var Ht=t.embed_templates.slice(2),At=[];for(wt=0;wt<Ht.length;wt+=1)At[wt]=se(e,q(t,Ht,wt));var kt=new H({root:e.root,store:e.store,slots:{default:c()}}),Ct=t.beforeExport;function Lt(t){return{root:e.root,store:e.store}}if(Ct)var Mt=new Ct(Lt());var Et=t.exportIntro&&re(e,t),jt=t.sortedChartActions,Ut=[];for(wt=0;wt<jt.length;wt+=1)Ut[wt]=ce(e,F(t,jt,wt));var It=t.Action;function St(t){return{root:e.root,store:e.store,data:{visible:!0,show:!0}}}if(It)var Ot=new It(St());return{c:function(){n=l("div"),st&&st.c(),a=u(" "),ot.c(),d=u("\n\n    "),_=l("button"),ut.c(),g=u("\n\n    "),ht&&ht.c(),w=u(" "),pt&&pt.c(),y=u(" "),ft&&ft.c(),x=u(" "),mt&&mt.c(),N=u(" "),bt&&bt.c(),T=u("\n\n    "),A=l("div"),k=l("h2"),L=u("\n        "),M=l("div"),E=l("i"),j=u("\n            "),U=l("div"),I=l("div"),S=l("b"),O=u("\n                    "),D=l("div"),G=l("label"),$=l("input"),P=u("\n                            "),ae=l("noscript"),oe=u("\n                        ");for(var i=0;i<gt.length;i+=1)gt[i].c();le=u("\n                "),ue=l("div"),de=l("a"),he=u(t.shareUrl),pe=u("\n            "),fe=l("div"),yt._fragment.c(),me=u("\n\n        "),be=l("div"),_e=l("i"),ve=u("\n            "),ge=l("div"),we=l("div"),ye=l("b"),xe=u("\n                    "),Ne=l("div");for(i=0;i<Nt.length;i+=1)Nt[i].c();Te=u("\n                "),He=l("div"),Ae=l("textarea"),ke=u("\n                    "),Ce=l("button"),Le=l("i"),Me=u(" "),Ee=u(tt),je=u("\n                    "),Ue=l("div"),Ie=u(nt),Oe=u("\n            "),De=l("div"),Ge=l("noscript"),$e=u(" ");for(i=0;i<At.length;i+=1)At[i].c();kt._fragment.c(),Fe=u("\n\n    \n    "),Mt&&Mt._fragment.c(),qe=u("\n\n    \n    "),Be=l("div"),ze=l("div"),Je=l("h2"),Ke=u("\n            "),Et&&Et.c(),Qe=u("\n\n        "),Re=l("ul");for(i=0;i<Ut.length;i+=1)Ut[i].c();Ve=u("\n\n        "),Ot&&Ot._fragment.c(),h(_,"click",dt),_.disabled=t.publishing,_.className=v="btn-publish btn btn-primary btn-large "+(t.published?"":"btn-first-publish")+" svelte-ia26hx",E.className="icon fa fa-link fa-fw",e._bindingGroups[0].push($),h($,"change",_t),$.__value="default",$.value=$.__value,f($,"type","radio"),$.name="url-type",$.className="svelte-ia26hx",G.className="radio",D.className="embed-options svelte-ia26hx",I.className="h",de.target="_blank",de.className="share-url svelte-ia26hx",de.href=t.shareUrl,ue.className="inpt",U.className="ctrls",M.className="block",_e.className="icon fa fa-code fa-fw",Ne.className="embed-options svelte-ia26hx",we.className="h",f(Ae,"type","text"),Ae.className="input embed-code svelte-ia26hx",Ae.readOnly=!0,Ae.value=t.embedCode,Le.className="fa fa-copy",h(Ce,"click",Tt),Ce.className="btn btn-copy",Ce.title="copy",Ue.className=Se="copy-success "+(t.copy_success?"show":"")+" svelte-ia26hx",He.className="inpt",ge.className="ctrls",be.className="block",b(A,"margin-top","30px"),A.className=Pe=t.published?"":"inactive",Je.className="pad-top",Re.className="chart-actions",Be.className="export-and-duplicate"},m:function(r,o){s(r,n,o),st&&st.m(n,null),i(n,a),ot.m(n,null),i(n,d),i(n,_),ut.m(_,null),i(n,g),ht&&ht.m(n,null),i(n,w),pt&&pt.m(n,null),i(n,y),ft&&ft.m(n,null),i(n,x),mt&&mt.m(n,null),i(n,N),bt&&bt.m(n,null),i(n,T),i(n,A),i(A,k),k.innerHTML=We,i(A,L),i(A,M),i(M,E),i(M,j),i(M,U),i(U,I),i(I,S),S.innerHTML=Xe,i(I,O),i(I,D),i(D,G),i(G,$),$.checked=$.__value===t.shareurl_type,i(G,P),i(G,ae),ae.insertAdjacentHTML("afterend",Ye),i(D,oe);for(var c=0;c<gt.length;c+=1)gt[c].m(D,null);i(U,le),i(U,ue),i(ue,de),i(de,he),i(M,pe),i(yt._slotted.default,fe),fe.innerHTML=Ze,yt._mount(M,null),i(A,me),i(A,be),i(be,_e),i(be,ve),i(be,ge),i(ge,we),i(we,ye),ye.innerHTML=et,i(we,xe),i(we,Ne);for(c=0;c<Nt.length;c+=1)Nt[c].m(Ne,null);i(ge,Te),i(ge,He),i(He,Ae),e.refs.embedInput=Ae,i(He,ke),i(He,Ce),i(Ce,Le),i(Ce,Me),i(Ce,Ee),i(He,je),i(He,Ue),i(Ue,Ie),i(be,Oe),i(kt._slotted.default,De),i(De,Ge),Ge.insertAdjacentHTML("beforebegin",it),i(De,$e);for(c=0;c<At.length;c+=1)At[c].m(De,null);kt._mount(be,null),i(n,Fe),Mt&&Mt._mount(n,null),i(n,qe),i(n,Be),i(Be,ze),i(ze,Je),Je.innerHTML=t.exportHed,i(ze,Ke),Et&&Et.m(ze,null),i(Be,Qe),i(Be,Re);for(c=0;c<Ut.length;c+=1)Ut[c].m(Re,null);i(Be,Ve),Ot&&(Ot._mount(Be,null),e.refs.action=Ot)},p:function(i,s){if((t=s).publishHed?st?st.p(i,t):((st=J(e,t)).c(),st.m(n,a)):st&&(st.d(1),st=null),at===(at=rt(t))&&ot?ot.p(i,t):(ot.d(1),(ot=at(e,t)).c(),ot.m(n,d)),lt===(lt=ct(t))&&ut?ut.p(i,t):(ut.d(1),(ut=lt(e,t)).c(),ut.m(_,null)),i.publishing&&(_.disabled=t.publishing),i.published&&v!==(v="btn-publish btn btn-primary btn-large "+(t.published?"":"btn-first-publish")+" svelte-ia26hx")&&(_.className=v),t.published?ht&&(ht.d(1),ht=null):ht||((ht=X()).c(),ht.m(n,w)),t.needs_republish&&!t.publishing?pt||((pt=Y()).c(),pt.m(n,y)):pt&&(pt.d(1),pt=null),!t.published||t.needs_republish||1!==t.progress||t.publishing?ft&&(ft.d(1),ft=null):ft||((ft=Z()).c(),ft.m(n,x)),t.publish_error?mt?mt.p(i,t):((mt=ee(e,t)).c(),mt.m(n,N)):mt&&(mt.d(1),mt=null),t.publishing?bt?bt.p(i,t):((bt=te(e,t)).c(),bt.m(n,T)):bt&&(bt.d(1),bt=null),i.shareurl_type&&($.checked=$.__value===t.shareurl_type),i.plugin_shareurls||i.shareurl_type){vt=t.plugin_shareurls;for(var r=0;r<vt.length;r+=1){var o=z(t,vt,r);gt[r]?gt[r].p(i,o):(gt[r]=ne(e,o),gt[r].c(),gt[r].m(D,null))}for(;r<gt.length;r+=1)gt[r].d(1);gt.length=vt.length}if(i.shareUrl&&(m(he,t.shareUrl),de.href=t.shareUrl),i.embed_templates||i.embed_type){xt=t.embed_templates;for(r=0;r<xt.length;r+=1){var c=B(t,xt,r);Nt[r]?Nt[r].p(i,c):(Nt[r]=ie(e,c),Nt[r].c(),Nt[r].m(Ne,null))}for(;r<Nt.length;r+=1)Nt[r].d(1);Nt.length=xt.length}if(i.embedCode&&(Ae.value=t.embedCode),i.copy_success&&Se!==(Se="copy-success "+(t.copy_success?"show":"")+" svelte-ia26hx")&&(Ue.className=Se),i.embed_templates){Ht=t.embed_templates.slice(2);for(r=0;r<Ht.length;r+=1){var l=q(t,Ht,r);At[r]?At[r].p(i,l):(At[r]=se(e,l),At[r].c(),At[r].m(De,null))}for(;r<At.length;r+=1)At[r].d(1);At.length=Ht.length}if(i.published&&Pe!==(Pe=t.published?"":"inactive")&&(A.className=Pe),Ct!==(Ct=t.beforeExport)&&(Mt&&Mt.destroy(),Ct?((Mt=new Ct(Lt()))._fragment.c(),Mt._mount(n,qe)):Mt=null),i.exportHed&&(Je.innerHTML=t.exportHed),t.exportIntro?Et?Et.p(i,t):((Et=re(e,t)).c(),Et.m(ze,null)):Et&&(Et.d(1),Et=null),i.sortedChartActions||i.active_action){jt=t.sortedChartActions;for(r=0;r<jt.length;r+=1){var u=F(t,jt,r);Ut[r]?Ut[r].p(i,u):(Ut[r]=ce(e,u),Ut[r].c(),Ut[r].m(Re,null))}for(;r<Ut.length;r+=1)Ut[r].d(1);Ut.length=jt.length}It!==(It=t.Action)&&(Ot&&Ot.destroy(),It?((Ot=new It(St()))._fragment.c(),Ot._mount(Be,null),e.refs.action=Ot):(Ot=null,e.refs.action===Ot&&(e.refs.action=null)))},d:function(t){t&&r(n),st&&st.d(),ot.d(),ut.d(),p(_,"click",dt),ht&&ht.d(),pt&&pt.d(),ft&&ft.d(),mt&&mt.d(),bt&&bt.d(),e._bindingGroups[0].splice(e._bindingGroups[0].indexOf($),1),p($,"change",_t),o(gt,t),yt.destroy(),o(Nt,t),e.refs.embedInput===Ae&&(e.refs.embedInput=null),p(Ce,"click",Tt),o(At,t),kt.destroy(),Mt&&Mt.destroy(),Et&&Et.d(),o(Ut,t),Ot&&Ot.destroy()}}}(this,this._state),this.root._oncreate.push((function(){G.call(a),a.fire("update",{changed:n({},a._state),current:a._state})})),e.target&&(this._fragment.c(),this._mount(e.target,e.anchor),v(this))}return t(le.prototype,x),t(le.prototype,D),le.prototype._recompute=function(e,t){var n,i,s;(e.shareurl_type||e.$id||e.$publicUrl||e.plugin_shareurls||e.published)&&this._differs(t.shareUrl,t.shareUrl=function(e){var t=e.shareurl_type,n=e.$id,i=e.$publicUrl,s=e.plugin_shareurls;if(!e.published)return"https://www.datawrapper.de/...";if("default"===t)return i;var r="";return s.forEach((function(e){e.id===t&&(r=e.url.replace(/%chart_id%/g,n))})),r}(t))&&(e.shareUrl=!0),(e.chartActions||e.$actions)&&this._differs(t.sortedChartActions,t.sortedChartActions=(i=(n=t).chartActions,s=n.$actions,i.concat(s).filter((function(e){return"publish-s3"!==e.id})).sort((function(e,t){return e.order-t.order}))))&&(e.sortedChartActions=!0)},{Publish:le}}));
